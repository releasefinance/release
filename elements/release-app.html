<link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-input/paper-input-container.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">


<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="./budget-page.html">
<link rel="import" href="./shares-page.html">
<link rel="import" href="./main-page.html">

<polymer-element name="release-app" >
  <template>
    <style shim-shadowdom>
      * {
        font-family: input, sans-serif;
      }
      :root {
        padding: 10px;
      }

      body {
        font-family: "InputSans-Regular", sans-serif;
      }

      h1 { font-family: "InputSans-Thin", sans-serif }

      h2 { font-family: "InputSans-Thin", sans-serif }

      h3 { font-family: "InputSans-Thin", sans-serif }

      h4 { font-family: "InputSans-Thin", sans-serif }

      h5 { font-family: "InputSans-Regular", sans-serif }

      h6 { font-family: "InputSans-Regular", sans-serif }


    </style>

    <div class="body-bg"></div>
    <neon-animated-pages selected="{{page}}" class="flex layout vertical" transition="cross-fade" entry-animation="fade-in-animation" exit-animation="fade-out-animation">

      <budget-page budget="{{budget}}" on-forward="forward" class="center-justified flex layout vertical"></budget-page>

      <shares-page shares="{{shares}}" on-forward="forward" class="center-justified flex layout vertical"></shares-page>

      <div class="flex layout horizontal">
        <div class="flex self-center centered">
          <h2>Searching for cars</h2>
          <paper-spinner active></paper-spinner>
        </div>
      </div>

      <main-page shares="{{shares}}" budget="{{budget}}" on-forward="forward" cars="{{cars}}" first_name="{{first_name}}" last_name="{{last_name}}" email="{{email}}" class="center-justified flex layout vertical"></main-page>

    </neon-animated-pages>
  </template>
  <script>
    Polymer({
      is: "release-app",

      properties: {
        page: {
          type: Number,
          value: 0
        },
        first_name: String,
        last_name: String,
        email: String,
        postcode: String,
        budget: Number,
        shares: Number,
        car: Object,

        cars: {
          type: Array,
          value: [],
          notify: true
        }
      },

      forward: function() {
        if(this.page == 5) {
          this.page = 0;
        } else {
          this.page = this.page + 1;
        }
        analytics.track('Page ' + this.page);
        if(this.page == 2) {
          this.async(function() {
            this.setupCars();
          },1000);
        }
      },
      ready: function() {
        analytics.track('View');
        window.app = this;
        this.budget = 400;
        this.shares = 2;
      },
      setupCars: function() {
        this.async(function() {
          this.set('cars', window.cars);
          this.forward();
        });
      }

    });
  </script>
</polymer-element>
